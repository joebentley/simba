(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     81947,       2207]
NotebookOptionsPosition[     77832,       2131]
NotebookOutlinePosition[     78225,       2147]
CellTagsIndexPosition[     78182,       2144]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "Simba`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Gamma]", "|", "s0", "|", "\[CapitalOmega]"}], ")"}], 
      "\[Element]", "Reals"}], ",", 
     RowBox[{"\[Gamma]", ">", "0"}], ",", 
     RowBox[{"s0", ">", "0"}], ",", 
     RowBox[{"\[CapitalOmega]", ">", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.801301755825293*^9, 3.801301770166497*^9}, {
  3.801301824800393*^9, 3.801301845420891*^9}, {3.80130187751151*^9, 
  3.801301888727845*^9}, {3.8013024168059397`*^9, 3.801302420138732*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"a2fbf2da-2edd-4e09-a0c2-df7691e02755"],

Cell[TextData[{
 "Looking at a system like:\n",
 StyleBox["---|----crystal----|\n", "CodeText"],
 "I.e. internal squeezing via the crystal, where the amplitude quadrature is \
squeezed and the phase quadrature is anti-squeezed (or vice versa)"
}], "Text",
 CellChangeTimes->{{3.8012928220450478`*^9, 
  3.801292888401394*^9}},ExpressionUUID->"8e106d1f-18fe-41bc-bfa6-\
15967becf950"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"umat", "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["2"]], 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "1"},
        {
         RowBox[{"-", "\[ImaginaryI]"}], "\[ImaginaryI]"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transferMatrix", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "a", ",", "ad", ",", "ain", ",", "aind", ",", "aout", ",", "aoutd", ",",
        "Qlist", ",", "Qlen", ",", "TFlist", ",", "DM", ",", "IMN", ",", 
       "TFM"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Qlist", "=", 
       RowBox[{"{", 
        RowBox[{
        "a", ",", "ad", ",", "ain", ",", "aind", ",", "aout", ",", "aoutd"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Qlen", "=", 
       RowBox[{"Length", "[", "Qlist", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Qlist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "=", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "Qlen"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TFlist", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "ad"}], "}"}], "\[Rule]", " ", 
          RowBox[{"(*", " ", "2", " ", "*)"}], 
          RowBox[{
           SqrtBox[
            RowBox[{"s0", " ", "\[Gamma]"}]], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CapitalOmega]"}], ")"}], 
            RowBox[{"-", "1"}]]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "a"}], "}"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", "\[Gamma]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CapitalOmega]"}], ")"}], 
            RowBox[{"-", "1"}]]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "ain"}], "}"}], "\[Rule]", 
          RowBox[{
           SqrtBox[
            RowBox[{"2", " ", "\[Gamma]"}]], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", " ", "\[ImaginaryI]"}], " ", "\[CapitalOmega]"}], 
             ")"}], 
            RowBox[{"-", "1"}]]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ad", ",", "a"}], "}"}], "\[Rule]", " ", 
          RowBox[{"(*", " ", "2", " ", "*)"}], 
          RowBox[{
           SqrtBox[
            RowBox[{"s0", " ", "\[Gamma]"}]], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CapitalOmega]"}], ")"}], 
            RowBox[{"-", "1"}]]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ad", ",", "ad"}], "}"}], "\[Rule]", 
          RowBox[{
           RowBox[{"-", "\[Gamma]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CapitalOmega]"}], ")"}], 
            RowBox[{"-", "1"}]]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ad", ",", "aind"}], "}"}], "\[Rule]", 
          RowBox[{
           SqrtBox[
            RowBox[{"2", " ", "\[Gamma]"}]], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", " ", "\[ImaginaryI]"}], " ", "\[CapitalOmega]"}], 
             ")"}], 
            RowBox[{"-", "1"}]]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"aout", ",", "ain"}], "}"}], "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"aoutd", ",", "aind"}], "}"}], "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"aout", ",", "a"}], "}"}], "\[Rule]", 
          SqrtBox[
           RowBox[{"2", "\[Gamma]"}]]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"aoutd", ",", "ad"}], "}"}], "\[Rule]", 
          SqrtBox[
           RowBox[{"2", "\[Gamma]"}]]}]}], "\[IndentingNewLine]", "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"DM", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{"TFlist", ",", 
         RowBox[{"{", 
          RowBox[{"Qlen", ",", "Qlen"}], "}"}]}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{"Dynamical", " ", "matrix"}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IMN", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Band", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", "1"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"Qlen", ",", "Qlen"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TFM", "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"IMN", "-", "DM"}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{"Transfer", " ", "function", " ", "matrix"}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"TFM", "[", 
            RowBox[{"[", 
             RowBox[{"aout", ",", "ain"}], "]"}], "]"}], ",", 
           RowBox[{"TFM", "[", 
            RowBox[{"[", 
             RowBox[{"aout", ",", "aind"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"TFM", "[", 
            RowBox[{"[", 
             RowBox[{"aoutd", ",", "ain"}], "]"}], "]"}], ",", 
           RowBox[{"TFM", "[", 
            RowBox[{"[", 
             RowBox[{"aoutd", ",", "aind"}], "]"}], "]"}]}], "}"}]}], "}"}], "//",
        "Simplify"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"umat", ".", "transferMatrix", ".", 
   RowBox[{"Inverse", "[", "umat", "]"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.8014593552863417`*^9, 3.801459635292406*^9}, {
  3.801459670387862*^9, 3.8014596727021437`*^9}, {3.8014600648279257`*^9, 
  3.801460102668542*^9}, {3.801460397263441*^9, 3.8014603991188707`*^9}, {
  3.801460595287951*^9, 3.801460596466851*^9}, {3.801460789585126*^9, 
  3.801460835669594*^9}, {3.801460885627253*^9, 3.801460896275255*^9}, {
  3.8014644399685593`*^9, 3.801464443279141*^9}, {3.801465421124138*^9, 
  3.801465423584147*^9}, {3.8014658869570007`*^9, 3.8014658890846453`*^9}, {
  3.801893653510118*^9, 3.8018936622175493`*^9}, {3.801893848666335*^9, 
  3.8018938504876423`*^9}, {3.8018939097674723`*^9, 3.801893924206284*^9}, {
  3.8019079242215757`*^9, 3.801907961273238*^9}, {3.802670301663041*^9, 
  3.80267031874282*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"2b08d5ab-6f7a-4323-9e2a-80fee58a4b41"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"s0", " ", "\[Gamma]"}], "+", 
       SuperscriptBox["\[Gamma]", "2"], "+", 
       RowBox[{"2", " ", "\[Gamma]", " ", 
        SqrtBox[
         RowBox[{"s0", " ", "\[Gamma]"}]]}], "+", 
       SuperscriptBox["\[CapitalOmega]", "2"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "s0"}], " ", "\[Gamma]"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}], ")"}], "2"]}]],
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"s0", " ", "\[Gamma]"}], "+", 
       SuperscriptBox["\[Gamma]", "2"], "-", 
       RowBox[{"2", " ", "\[Gamma]", " ", 
        SqrtBox[
         RowBox[{"s0", " ", "\[Gamma]"}]]}], "+", 
       SuperscriptBox["\[CapitalOmega]", "2"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "s0"}], " ", "\[Gamma]"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}], ")"}], 
        "2"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8026703190205297`*^9, 3.80276007380853*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"20d1b5ac-9b01-4535-9e5c-6154205fcefe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"s0", " ", "\[Gamma]"}], "+", 
     SuperscriptBox["\[Gamma]", "2"], "+", 
     RowBox[{"2", " ", "\[Gamma]", " ", 
      SqrtBox[
       RowBox[{"s0", " ", "\[Gamma]"}]]}], "+", 
     SuperscriptBox["\[CapitalOmega]", "2"]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "s0"}], " ", "\[Gamma]"}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Gamma]", "-", 
        RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}], ")"}], "2"]}]], "==", 
   FractionBox[
    RowBox[{"\[Gamma]", "+", 
     SqrtBox[
      RowBox[{"s0", " ", "\[Gamma]"}]], "+", 
     RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}], 
    RowBox[{"\[Gamma]", "-", 
     SqrtBox[
      RowBox[{"s0", " ", "\[Gamma]"}]], "-", 
     RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}]]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.801893855846922*^9, 3.8018938810306377`*^9}, {
  3.801893930214855*^9, 3.801893932330447*^9}, {3.8019079100660954`*^9, 
  3.8019079104761257`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"361fb27e-7961-439a-a6cf-9acaefaa66a4"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8018938597594223`*^9, 3.801893881339817*^9}, 
   3.8018939326610193`*^9, 3.8019079107070627`*^9, 3.8019079690862627`*^9, 
   3.801997692629859*^9, 3.802079106916656*^9, {3.802497448171226*^9, 
   3.802497469453286*^9}, 3.802601134116823*^9, 3.802760073851531*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"aaf20332-23f8-4730-9d9e-40c08c27ba07"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["transferMatrix"], "Input",
 CellChangeTimes->{{3.8018939554340982`*^9, 3.801893961466674*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"05a7a15b-acc9-41a3-984b-e629ddec120a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"s0", " ", "\[Gamma]"}], "+", 
        SuperscriptBox["\[Gamma]", "2"], "+", 
        SuperscriptBox["\[CapitalOmega]", "2"]}], 
       RowBox[{
        RowBox[{"s0", " ", "\[Gamma]"}], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Gamma]", "-", 
           RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}], ")"}], 
         "2"]}]]}], ",", 
     FractionBox[
      RowBox[{"2", " ", "\[Gamma]", " ", 
       SqrtBox[
        RowBox[{"s0", " ", "\[Gamma]"}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "s0"}], " ", "\[Gamma]"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}], ")"}], 
        "2"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", "\[Gamma]", " ", 
       SqrtBox[
        RowBox[{"s0", " ", "\[Gamma]"}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "s0"}], " ", "\[Gamma]"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}], ")"}], "2"]}]],
      ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"s0", " ", "\[Gamma]"}], "+", 
        SuperscriptBox["\[Gamma]", "2"], "+", 
        SuperscriptBox["\[CapitalOmega]", "2"]}], 
       RowBox[{
        RowBox[{"s0", " ", "\[Gamma]"}], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Gamma]", "-", 
           RowBox[{"\[ImaginaryI]", " ", "\[CapitalOmega]"}]}], ")"}], 
         "2"]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.801893956325749*^9, 3.8018939619831038`*^9}, 
   3.8019079184179773`*^9, 3.801908239928712*^9, 3.801997692635768*^9, 
   3.802079106925362*^9, {3.802497448204074*^9, 3.802497469460165*^9}, {
   3.80249955131109*^9, 3.802499555877288*^9}, 3.802601134130155*^9, 
   3.802760073864317*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"40903f1f-d6fc-4ed7-8aec-0aa9748af522"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"transferMatrix", "/.", 
    RowBox[{"s0", "\[Rule]", "\[Gamma]"}]}], "/.", 
   RowBox[{"\[CapitalOmega]", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "s"}]}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.8020768108901033`*^9, 3.80207683245265*^9}, 
   3.802499546054161*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"8c626020-942e-464e-91d8-0446583eed4f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["s", "2"], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}], 
       RowBox[{
        SuperscriptBox["s", "2"], "-", 
        RowBox[{"2", " ", "s", " ", "\[Gamma]"}]}]]}], ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["\[Gamma]", "2"]}], 
      RowBox[{
       SuperscriptBox["s", "2"], "-", 
       RowBox[{"2", " ", "s", " ", "\[Gamma]"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["\[Gamma]", "2"]}], 
      RowBox[{
       SuperscriptBox["s", "2"], "-", 
       RowBox[{"2", " ", "s", " ", "\[Gamma]"}]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["s", "2"], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}], 
       RowBox[{
        SuperscriptBox["s", "2"], "-", 
        RowBox[{"2", " ", "s", " ", "\[Gamma]"}]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.802076827384741*^9, 3.802076832816359*^9}, 
   3.80207910695682*^9, {3.802497448234928*^9, 3.802497469482758*^9}, 
   3.8024995496189632`*^9, 3.802601134164197*^9, 3.8027600738992577`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"23e8f21d-09ed-4271-ba7c-8872d9d82273"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Reading", " ", "off", " ", "from", " ", "equations", " ", "of", " ", 
    "motion"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ssPhysical", "=", 
   RowBox[{"StateSpaceModel", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Gamma]"}], ",", 
          SqrtBox[
           RowBox[{"s0", " ", "\[Gamma]"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SqrtBox[
           RowBox[{"s0", " ", "\[Gamma]"}]], ",", 
          RowBox[{"-", "\[Gamma]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{
       SqrtBox[
        RowBox[{"2", "\[Gamma]"}]], 
       RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
      RowBox[{
       SqrtBox[
        RowBox[{"2", "\[Gamma]"}]], 
       RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}], "}"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.802682171005217*^9, 3.8026822250135937`*^9}, {
  3.802682271000017*^9, 3.802682404389515*^9}, {3.802682602043157*^9, 
  3.802682658357212*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"4f20be1a-bffa-4e5a-9950-3ca713a5fe8d"],

Cell[BoxData[
 TemplateBox[{
   RowBox[{"-", "\[Gamma]"}], 
   SqrtBox[
    RowBox[{"s0", " ", "\[Gamma]"}]], 
   RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox["\[Gamma]"]}], "0", 
   SqrtBox[
    RowBox[{"s0", " ", "\[Gamma]"}]], 
   RowBox[{"-", "\[Gamma]"}], "0", 
   RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox["\[Gamma]"]}], 
   RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox["\[Gamma]"]}], "0", 
   RowBox[{"-", "1"}], "0", "0", 
   RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox["\[Gamma]"]}], "0", 
   RowBox[{"-", "1"}], 
   InterpretationBox["\[InvisibleSpace]", None], {
   StateSpaceModel, {
    False, False, {
     False, False}}, {$CellContext`stname1, $CellContext`stname2}, {{
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}}, Identity, 
    Automatic, 2, 2, 2, 1, {}, {False, False}, False, Automatic, None, 
    Automatic}, {}},
  "StateSpaceModelFull",
  BaseStyle->{NumberMarks -> False},
  DisplayFunction->(TagBox[
    SubsuperscriptBox[
     RowBox[{"(", 
       GridBox[{{#, #2, #3, #4}, {#5, #6, #7, #8}, {#9, #10, #11, #12}, {#13, \
#14, #15, #16}}, AllowedDimensions -> {4, 4}, 
        GridBoxDividers -> {"Rows" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}, "Columns" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}}, DefaultBaseStyle -> 
        "SystemsModelGrid00"], ")"}], #17, 
     ButtonBox[
      GraphicsBox[{
        RectangleBox[{0, 0}, DefaultBaseStyle -> "SystemsModelSuperscript"], 
        InsetBox[
         StyleBox[
         "\[ScriptCapitalS]", DefaultBaseStyle -> 
          "SystemsModelSuperscript"], {0.5, 0.5}]}, ImageSize -> 20], 
      ButtonFunction :> Control`Typesetting`SystemsModelTypesetToggle[
        ButtonNotebook[], FE`CMObj], Evaluator -> Automatic, Appearance -> 
      None], MultilineFunction -> None], 
    EventHandlerTag[{"MouseEntered" :> {FE`CMObj = MathLink`CallFrontEnd[
          FrontEnd`Value[
           FEPrivate`Self[]]]}, PassEventsDown -> True, PassEventsUp -> 
      True}]]& ),
  InterpretationFunction->(RowBox[{"StateSpaceModel", "[", 
     RowBox[{"{", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{1, 2}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{5, 6}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{3, 4}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{7, 8}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{9, 10}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{13, 14}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{11, 12}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{15, 16}, ","], "}"}], "}"}], "}"}], ",", 
     "SamplingPeriod", "->", 
     RowBox[{#17}], ",", "SystemsModelLabels", "->", "None", "]"}]& ),
  Tooltip->StateSpaceModel]], "Output",
 CellChangeTimes->{{3.802682602357905*^9, 3.802682610611807*^9}, 
   3.8026826766123753`*^9, 3.802760077134049*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"51aac1df-44d9-46df-9ebd-bd1c8e212076"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SymplecticJ", "[", 
    RowBox[{"transferMatrix", ",", " ", "s"}], "]"}], "\[Equal]", 
   RowBox[{"JMatrix", "[", "1", "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.801460597374321*^9, 3.801460605640723*^9}, {
   3.801891360031345*^9, 3.8018913668191967`*^9}, {3.802072150765335*^9, 
   3.8020721971400537`*^9}, 3.802076869686597*^9, 3.802076933994771*^9, {
   3.8020771662032824`*^9, 3.8020771663756227`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"aaa038bb-2b99-4812-bb36-38aa7111cad9"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.801460602440713*^9, 3.801460606030724*^9}, 
   3.8014608067841663`*^9, {3.801891367918592*^9, 3.801891384870881*^9}, 
   3.801893690387311*^9, 3.80189394153419*^9, {3.801908247084012*^9, 
   3.801908254342717*^9}, 3.801997692788742*^9, {3.8020721430894012`*^9, 
   3.802072165560732*^9}, 3.802072197668442*^9, 3.802076870180122*^9, {
   3.802076930903167*^9, 3.8020769801090117`*^9}, {3.8020771041543427`*^9, 
   3.802077124591751*^9}, {3.802077164121038*^9, 3.802077196486895*^9}, 
   3.8020791069796457`*^9, 3.80215551510078*^9, {3.802497448278887*^9, 
   3.802497469513974*^9}, 3.8024995584910727`*^9, 3.802601134308055*^9, 
   3.802760078048376*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"381b35d2-4f6e-4b9c-9333-3949ff8e370a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ss", "=", 
  RowBox[{
   RowBox[{"MinimalStateSpaceModel", "@", 
    RowBox[{"StateSpaceModel", "[", 
     RowBox[{"TransferFunctionModel", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "transferMatrix"}], "/.", 
          RowBox[{"s0", "\[Rule]", "\[Gamma]"}]}], "/.", 
         RowBox[{"\[CapitalOmega]", "\[Rule]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "s"}]}]}], "/.", 
        RowBox[{"s", "\[Rule]", 
         RowBox[{"-", "s"}]}]}], ",", " ", "s"}], "]"}], "]"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.801893993228691*^9, 3.801894061095557*^9}, {
   3.801894098564768*^9, 3.801894107137569*^9}, 3.8019082686276913`*^9, {
   3.801909643786396*^9, 3.801909646240429*^9}, {3.801909706017516*^9, 
   3.801909706929237*^9}, {3.801911600772826*^9, 3.80191161469424*^9}, {
   3.801911698726384*^9, 3.8019117315415373`*^9}, {3.801997681035739*^9, 
   3.801997683772434*^9}, {3.80207917083946*^9, 3.8020791721563797`*^9}, 
   3.8020800554357557`*^9, {3.802430033781831*^9, 3.802430066139339*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"06abb1b6-cf5f-4ea6-b33a-f18452c28ea1"],

Cell[BoxData[
 TemplateBox[{
   RowBox[{"-", 
     FractionBox["\[Gamma]", 
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
   FractionBox[
    RowBox[{"\[Gamma]", " ", 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"4", " ", 
           SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
    RowBox[{"1", "+", 
      RowBox[{"2", " ", 
        SuperscriptBox["\[Gamma]", "2"]}]}]], "0", 
   FractionBox["1", 
    SqrtBox[
     RowBox[{"1", "+", 
       RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}]]], 
   FractionBox[
    RowBox[{"\[Gamma]", " ", 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"4", " ", 
           SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
    RowBox[{"1", "+", 
      RowBox[{"2", " ", 
        SuperscriptBox["\[Gamma]", "2"]}]}]], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"\[Gamma]", "+", 
        RowBox[{"4", " ", 
          SuperscriptBox["\[Gamma]", "3"]}]}], 
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
   SqrtBox[
    FractionBox[
     RowBox[{"1", "+", 
       RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}], 
     RowBox[{"1", "+", 
       RowBox[{"4", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}]]], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
        SuperscriptBox["\[Gamma]", "2"]}], 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"6", " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "+", 
         RowBox[{"8", " ", 
           SuperscriptBox["\[Gamma]", "4"]}]}]]]}], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"4", " ", 
        SuperscriptBox["\[Gamma]", "2"]}], 
      SqrtBox[
       RowBox[{"2", "+", 
         FractionBox["1", 
          SuperscriptBox["\[Gamma]", "2"]]}]]]}], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
        RowBox[{"(", 
          RowBox[{"\[Gamma]", "+", 
            RowBox[{"4", " ", 
              SuperscriptBox["\[Gamma]", "3"]}]}], ")"}]}], 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"6", " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "+", 
         RowBox[{"8", " ", 
           SuperscriptBox["\[Gamma]", "4"]}]}]]]}], "1", "0", 
   RowBox[{
     RowBox[{"-", "2"}], " ", "\[Gamma]", " ", 
     SqrtBox[
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]}], "0", "0", "1", 
   InterpretationBox["\[InvisibleSpace]", None], {
   StateSpaceModel, {
    False, False, {
     False, False}}, {$CellContext`stname1, $CellContext`stname2}, {{
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}}, Identity, 
    Automatic, 2, 2, 2, 1, {}, {False, False}, False, Automatic, None, 
    Automatic}, {}},
  "StateSpaceModelMinimal",
  BaseStyle->{NumberMarks -> False},
  DisplayFunction->(TagBox[
    SubsuperscriptBox[
     RowBox[{"(", 
       GridBox[{{
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #2], #3, 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #4]}, {
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #5], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #6], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #7], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #8]}, {
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #9], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #10], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", 
             "SystemsModelMinimalElement"]], #11], #12}, {
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", 
             "SystemsModelMinimalElement"]], #13], #14, #15, 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #16]}}, 
        AllowedDimensions -> {4, 4}, 
        GridBoxDividers -> {"Rows" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}, "Columns" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}}, DefaultBaseStyle -> 
        "SystemsModelGrid00"], ")"}], #17, 
     ButtonBox[
      GraphicsBox[{
        RectangleBox[{0, 0}, DefaultBaseStyle -> "SystemsModelSuperscript"], 
        InsetBox[
         StyleBox[
         "\[ScriptCapitalS]", DefaultBaseStyle -> 
          "SystemsModelSuperscript"], {0.5, 0.5}]}, ImageSize -> 20], 
      ButtonFunction :> Control`Typesetting`SystemsModelTypesetToggle[
        ButtonNotebook[], FE`CMObj], Evaluator -> Automatic, Appearance -> 
      None], MultilineFunction -> None], 
    EventHandlerTag[{"MouseEntered" :> {FE`CMObj = MathLink`CallFrontEnd[
          FrontEnd`Value[
           FEPrivate`Self[]]]}, PassEventsDown -> True, PassEventsUp -> 
      True}]]& ),
  InterpretationFunction->(RowBox[{"StateSpaceModel", "[", 
     RowBox[{"{", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{1, 2}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{5, 6}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{3, 4}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{7, 8}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{9, 10}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{13, 14}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{11, 12}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{15, 16}, ","], "}"}], "}"}], "}"}], ",", 
     "SamplingPeriod", "->", 
     RowBox[{#17}], ",", "SystemsModelLabels", "->", "None", "]"}]& ),
  Tooltip->StateSpaceModel]], "Output",
 CellChangeTimes->{{3.802497451937653*^9, 3.802497473692746*^9}, 
   3.8024995609641953`*^9, {3.80249970582981*^9, 3.802499715258745*^9}, 
   3.802601135612536*^9, 3.802668810381288*^9, 3.802670159582118*^9, 
   3.802760078779015*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"033477f4-f008-4012-8400-e1d3ce20db14"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 TemplateBox[{
   RowBox[{"-", 
     FractionBox["\[Gamma]", 
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
   FractionBox[
    RowBox[{"\[Gamma]", " ", 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"4", " ", 
           SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
    RowBox[{"1", "+", 
      RowBox[{"2", " ", 
        SuperscriptBox["\[Gamma]", "2"]}]}]], "0", 
   FractionBox["1", 
    SqrtBox[
     RowBox[{"1", "+", 
       RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}]]], 
   FractionBox[
    RowBox[{"\[Gamma]", " ", 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"4", " ", 
           SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
    RowBox[{"1", "+", 
      RowBox[{"2", " ", 
        SuperscriptBox["\[Gamma]", "2"]}]}]], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"\[Gamma]", "+", 
        RowBox[{"4", " ", 
          SuperscriptBox["\[Gamma]", "3"]}]}], 
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
   SqrtBox[
    FractionBox[
     RowBox[{"1", "+", 
       RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}], 
     RowBox[{"1", "+", 
       RowBox[{"4", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}]]], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
        SuperscriptBox["\[Gamma]", "2"]}], 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"6", " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "+", 
         RowBox[{"8", " ", 
           SuperscriptBox["\[Gamma]", "4"]}]}]]]}], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"4", " ", 
        SuperscriptBox["\[Gamma]", "2"]}], 
      SqrtBox[
       RowBox[{"2", "+", 
         FractionBox["1", 
          SuperscriptBox["\[Gamma]", "2"]]}]]]}], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
        RowBox[{"(", 
          RowBox[{"\[Gamma]", "+", 
            RowBox[{"4", " ", 
              SuperscriptBox["\[Gamma]", "3"]}]}], ")"}]}], 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"6", " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "+", 
         RowBox[{"8", " ", 
           SuperscriptBox["\[Gamma]", "4"]}]}]]]}], "1", "0", 
   RowBox[{
     RowBox[{"-", "2"}], " ", "\[Gamma]", " ", 
     SqrtBox[
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]}], "0", "0", "1", 
   InterpretationBox["\[InvisibleSpace]", None], {
   StateSpaceModel, {
    False, False, {
     False, False}}, {$CellContext`stname1, $CellContext`stname2}, {{
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}}, Identity, 
    Automatic, 2, 2, 2, 1, {}, {False, False}, False, Automatic, None, 
    Automatic}, {}},
  "StateSpaceModelFull",
  BaseStyle->{NumberMarks -> False},
  DisplayFunction->(TagBox[
    SubsuperscriptBox[
     RowBox[{"(", 
       GridBox[{{#, #2, #3, #4}, {#5, #6, #7, #8}, {#9, #10, #11, #12}, {#13, \
#14, #15, #16}}, AllowedDimensions -> {4, 4}, 
        GridBoxDividers -> {"Rows" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}, "Columns" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}}, DefaultBaseStyle -> 
        "SystemsModelGrid00"], ")"}], #17, 
     ButtonBox[
      GraphicsBox[{
        RectangleBox[{0, 0}, DefaultBaseStyle -> "SystemsModelSuperscript"], 
        InsetBox[
         StyleBox[
         "\[ScriptCapitalS]", DefaultBaseStyle -> 
          "SystemsModelSuperscript"], {0.5, 0.5}]}, ImageSize -> 20], 
      ButtonFunction :> Control`Typesetting`SystemsModelTypesetToggle[
        ButtonNotebook[], FE`CMObj], Evaluator -> Automatic, Appearance -> 
      None], MultilineFunction -> None], 
    EventHandlerTag[{"MouseEntered" :> {FE`CMObj = MathLink`CallFrontEnd[
          FrontEnd`Value[
           FEPrivate`Self[]]]}, PassEventsDown -> True, PassEventsUp -> 
      True}]]& ),
  InterpretationFunction->(RowBox[{"StateSpaceModel", "[", 
     RowBox[{"{", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{1, 2}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{5, 6}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{3, 4}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{7, 8}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{9, 10}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{13, 14}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{11, 12}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{15, 16}, ","], "}"}], "}"}], "}"}], ",", 
     "SamplingPeriod", "->", 
     RowBox[{#17}], ",", "SystemsModelLabels", "->", "None", "]"}]& ),
  Tooltip->StateSpaceModel]], "Input",
 CellChangeTimes->{{3.802430068487837*^9, 3.802430068493372*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"2797ea73-4ba5-40fe-9a2e-85981c9a46d6"],

Cell[BoxData[
 TemplateBox[{
   RowBox[{"-", 
     FractionBox["\[Gamma]", 
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
   FractionBox[
    RowBox[{"\[Gamma]", " ", 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"4", " ", 
           SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
    RowBox[{"1", "+", 
      RowBox[{"2", " ", 
        SuperscriptBox["\[Gamma]", "2"]}]}]], "0", 
   FractionBox["1", 
    SqrtBox[
     RowBox[{"1", "+", 
       RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}]]], 
   FractionBox[
    RowBox[{"\[Gamma]", " ", 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"4", " ", 
           SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
    RowBox[{"1", "+", 
      RowBox[{"2", " ", 
        SuperscriptBox["\[Gamma]", "2"]}]}]], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"\[Gamma]", "+", 
        RowBox[{"4", " ", 
          SuperscriptBox["\[Gamma]", "3"]}]}], 
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
   SqrtBox[
    FractionBox[
     RowBox[{"1", "+", 
       RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}], 
     RowBox[{"1", "+", 
       RowBox[{"4", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}]]], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
        SuperscriptBox["\[Gamma]", "2"]}], 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"6", " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "+", 
         RowBox[{"8", " ", 
           SuperscriptBox["\[Gamma]", "4"]}]}]]]}], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"4", " ", 
        SuperscriptBox["\[Gamma]", "2"]}], 
      SqrtBox[
       RowBox[{"2", "+", 
         FractionBox["1", 
          SuperscriptBox["\[Gamma]", "2"]]}]]]}], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
        RowBox[{"(", 
          RowBox[{"\[Gamma]", "+", 
            RowBox[{"4", " ", 
              SuperscriptBox["\[Gamma]", "3"]}]}], ")"}]}], 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"6", " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "+", 
         RowBox[{"8", " ", 
           SuperscriptBox["\[Gamma]", "4"]}]}]]]}], "1", "0", 
   RowBox[{
     RowBox[{"-", "2"}], " ", "\[Gamma]", " ", 
     SqrtBox[
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]}], "0", "0", "1", 
   InterpretationBox["\[InvisibleSpace]", None], {
   StateSpaceModel, {
    False, False, {
     False, False}}, {$CellContext`stname1, $CellContext`stname2}, {{
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}}, Identity, 
    Automatic, 2, 2, 2, 1, {}, {False, False}, False, Automatic, None, 
    Automatic}, {}},
  "StateSpaceModelMinimal",
  BaseStyle->{NumberMarks -> False},
  DisplayFunction->(TagBox[
    SubsuperscriptBox[
     RowBox[{"(", 
       GridBox[{{
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #2], #3, 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #4]}, {
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #5], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #6], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #7], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #8]}, {
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #9], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #10], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", 
             "SystemsModelMinimalElement"]], #11], #12}, {
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", 
             "SystemsModelMinimalElement"]], #13], #14, #15, 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #16]}}, 
        AllowedDimensions -> {4, 4}, 
        GridBoxDividers -> {"Rows" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}, "Columns" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}}, DefaultBaseStyle -> 
        "SystemsModelGrid00"], ")"}], #17, 
     ButtonBox[
      GraphicsBox[{
        RectangleBox[{0, 0}, DefaultBaseStyle -> "SystemsModelSuperscript"], 
        InsetBox[
         StyleBox[
         "\[ScriptCapitalS]", DefaultBaseStyle -> 
          "SystemsModelSuperscript"], {0.5, 0.5}]}, ImageSize -> 20], 
      ButtonFunction :> Control`Typesetting`SystemsModelTypesetToggle[
        ButtonNotebook[], FE`CMObj], Evaluator -> Automatic, Appearance -> 
      None], MultilineFunction -> None], 
    EventHandlerTag[{"MouseEntered" :> {FE`CMObj = MathLink`CallFrontEnd[
          FrontEnd`Value[
           FEPrivate`Self[]]]}, PassEventsDown -> True, PassEventsUp -> 
      True}]]& ),
  InterpretationFunction->(RowBox[{"StateSpaceModel", "[", 
     RowBox[{"{", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{1, 2}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{5, 6}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{3, 4}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{7, 8}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{9, 10}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{13, 14}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{11, 12}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{15, 16}, ","], "}"}], "}"}], "}"}], ",", 
     "SamplingPeriod", "->", 
     RowBox[{#17}], ",", "SystemsModelLabels", "->", "None", "]"}]& ),
  Tooltip->StateSpaceModel]], "Output",
 CellChangeTimes->{{3.8024974526968613`*^9, 3.802497474287176*^9}, 
   3.802601135910985*^9, 3.802760079155694*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"c9b3c89c-7c2d-4a04-8873-6425c2009161"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ss", "=", 
  TemplateBox[{
    RowBox[{"-", 
      FractionBox["\[Gamma]", 
       RowBox[{"1", "+", 
         RowBox[{"2", " ", 
           SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
    FractionBox[
     RowBox[{"\[Gamma]", " ", 
       SqrtBox[
        RowBox[{"1", "+", 
          RowBox[{"4", " ", 
            SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
     RowBox[{"1", "+", 
       RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}]], "0", 
    FractionBox["1", 
     SqrtBox[
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]], 
    FractionBox[
     RowBox[{"\[Gamma]", " ", 
       SqrtBox[
        RowBox[{"1", "+", 
          RowBox[{"4", " ", 
            SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
     RowBox[{"1", "+", 
       RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}]], 
    RowBox[{"-", 
      FractionBox[
       RowBox[{"\[Gamma]", "+", 
         RowBox[{"4", " ", 
           SuperscriptBox["\[Gamma]", "3"]}]}], 
       RowBox[{"1", "+", 
         RowBox[{"2", " ", 
           SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
    SqrtBox[
     FractionBox[
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}], 
      RowBox[{"1", "+", 
        RowBox[{"4", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]], 
    RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}], 
       SqrtBox[
        RowBox[{"1", "+", 
          RowBox[{"6", " ", 
            SuperscriptBox["\[Gamma]", "2"]}], "+", 
          RowBox[{"8", " ", 
            SuperscriptBox["\[Gamma]", "4"]}]}]]]}], 
    RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " ", 
         SuperscriptBox["\[Gamma]", "2"]}], 
       SqrtBox[
        RowBox[{"2", "+", 
          FractionBox["1", 
           SuperscriptBox["\[Gamma]", "2"]]}]]]}], 
    RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
         RowBox[{"(", 
           RowBox[{"\[Gamma]", "+", 
             RowBox[{"4", " ", 
               SuperscriptBox["\[Gamma]", "3"]}]}], ")"}]}], 
       SqrtBox[
        RowBox[{"1", "+", 
          RowBox[{"6", " ", 
            SuperscriptBox["\[Gamma]", "2"]}], "+", 
          RowBox[{"8", " ", 
            SuperscriptBox["\[Gamma]", "4"]}]}]]]}], "1", "0", 
    RowBox[{
      RowBox[{"-", "2"}], " ", "\[Gamma]", " ", 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"2", " ", 
           SuperscriptBox["\[Gamma]", "2"]}]}]]}], "0", "0", "1", 
    InterpretationBox["\[InvisibleSpace]", None], {
    StateSpaceModel, {
     False, False, {
      False, False}}, {$CellContext`stname1, $CellContext`stname2}, {{
      Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
      Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
      Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}}, Identity, 
     Automatic, 2, 2, 2, 1, {}, {False, False}, False, Automatic, None, 
     Automatic}, {}},
   "StateSpaceModelFull",
   BaseStyle->{NumberMarks -> False},
   DisplayFunction->(TagBox[
     SubsuperscriptBox[
      RowBox[{"(", 
        GridBox[{{#, #2, #3, #4}, {#5, #6, #7, #8}, {#9, #10, #11, #12}, \
{#13, #14, #15, #16}}, AllowedDimensions -> {4, 4}, 
         GridBoxDividers -> {"Rows" -> {False, False, 
             Directive[
              GrayLevel[0], 
              GrayLevel[0.6]], {False}, False}, "Columns" -> {False, False, 
             Directive[
              GrayLevel[0], 
              GrayLevel[0.6]], {False}, False}}, DefaultBaseStyle -> 
         "SystemsModelGrid00"], ")"}], #17, 
      ButtonBox[
       GraphicsBox[{
         RectangleBox[{0, 0}, DefaultBaseStyle -> "SystemsModelSuperscript"], 
         
         InsetBox[
          StyleBox[
          "\[ScriptCapitalS]", DefaultBaseStyle -> 
           "SystemsModelSuperscript"], {0.5, 0.5}]}, ImageSize -> 20], 
       ButtonFunction :> Control`Typesetting`SystemsModelTypesetToggle[
         ButtonNotebook[], FE`CMObj], Evaluator -> Automatic, Appearance -> 
       None], MultilineFunction -> None], 
     EventHandlerTag[{"MouseEntered" :> {FE`CMObj = MathLink`CallFrontEnd[
           FrontEnd`Value[
            FEPrivate`Self[]]]}, PassEventsDown -> True, PassEventsUp -> 
       True}]]& ),
   InterpretationFunction->(RowBox[{"StateSpaceModel", "[", 
      RowBox[{"{", 
        RowBox[{"{", 
          RowBox[{"{", 
            TemplateSlotSequence[{1, 2}, ","], "}"}], ",", 
          RowBox[{"{", 
            TemplateSlotSequence[{5, 6}, ","], "}"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"{", 
            TemplateSlotSequence[{3, 4}, ","], "}"}], ",", 
          RowBox[{"{", 
            TemplateSlotSequence[{7, 8}, ","], "}"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"{", 
            TemplateSlotSequence[{9, 10}, ","], "}"}], ",", 
          RowBox[{"{", 
            TemplateSlotSequence[{13, 14}, ","], "}"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"{", 
            TemplateSlotSequence[{11, 12}, ","], "}"}], ",", 
          RowBox[{"{", 
            TemplateSlotSequence[{15, 16}, ","], "}"}], "}"}], "}"}], ",", 
      "SamplingPeriod", "->", 
      RowBox[{#17}], ",", "SystemsModelLabels", "->", "None", "]"}]& ),
   Tooltip->StateSpaceModel]}]], "Input",
 CellChangeTimes->{{3.8020800621998453`*^9, 3.802080064168929*^9}, {
  3.8024300476214046`*^9, 3.80243007590812*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"feeae2e0-8c41-4c0a-932e-336a158b171f"],

Cell[BoxData[
 TemplateBox[{
   RowBox[{"-", 
     FractionBox["\[Gamma]", 
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
   FractionBox[
    RowBox[{"\[Gamma]", " ", 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"4", " ", 
           SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
    RowBox[{"1", "+", 
      RowBox[{"2", " ", 
        SuperscriptBox["\[Gamma]", "2"]}]}]], "0", 
   FractionBox["1", 
    SqrtBox[
     RowBox[{"1", "+", 
       RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}]]], 
   FractionBox[
    RowBox[{"\[Gamma]", " ", 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"4", " ", 
           SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
    RowBox[{"1", "+", 
      RowBox[{"2", " ", 
        SuperscriptBox["\[Gamma]", "2"]}]}]], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"\[Gamma]", "+", 
        RowBox[{"4", " ", 
          SuperscriptBox["\[Gamma]", "3"]}]}], 
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]}], 
   SqrtBox[
    FractionBox[
     RowBox[{"1", "+", 
       RowBox[{"2", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}], 
     RowBox[{"1", "+", 
       RowBox[{"4", " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}]]], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
        SuperscriptBox["\[Gamma]", "2"]}], 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"6", " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "+", 
         RowBox[{"8", " ", 
           SuperscriptBox["\[Gamma]", "4"]}]}]]]}], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"4", " ", 
        SuperscriptBox["\[Gamma]", "2"]}], 
      SqrtBox[
       RowBox[{"2", "+", 
         FractionBox["1", 
          SuperscriptBox["\[Gamma]", "2"]]}]]]}], 
   RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
        RowBox[{"(", 
          RowBox[{"\[Gamma]", "+", 
            RowBox[{"4", " ", 
              SuperscriptBox["\[Gamma]", "3"]}]}], ")"}]}], 
      SqrtBox[
       RowBox[{"1", "+", 
         RowBox[{"6", " ", 
           SuperscriptBox["\[Gamma]", "2"]}], "+", 
         RowBox[{"8", " ", 
           SuperscriptBox["\[Gamma]", "4"]}]}]]]}], "1", "0", 
   RowBox[{
     RowBox[{"-", "2"}], " ", "\[Gamma]", " ", 
     SqrtBox[
      RowBox[{"1", "+", 
        RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}]]}], "0", "0", "1", 
   InterpretationBox["\[InvisibleSpace]", None], {
   StateSpaceModel, {
    False, False, {
     False, False}}, {$CellContext`stname1, $CellContext`stname2}, {{
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}}, Identity, 
    Automatic, 2, 2, 2, 1, {}, {False, False}, False, Automatic, None, 
    Automatic}, {}},
  "StateSpaceModelMinimal",
  BaseStyle->{NumberMarks -> False},
  DisplayFunction->(TagBox[
    SubsuperscriptBox[
     RowBox[{"(", 
       GridBox[{{
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #2], #3, 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #4]}, {
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #5], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #6], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #7], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #8]}, {
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #9], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #10], 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", 
             "SystemsModelMinimalElement"]], #11], #12}, {
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", 
             "SystemsModelMinimalElement"]], #13], #14, #15, 
          TooltipBox[
           StyleBox[
            StyleBox[
            "\[FilledSmallSquare]", "SystemsModelMinimalElement"]], #16]}}, 
        AllowedDimensions -> {4, 4}, 
        GridBoxDividers -> {"Rows" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}, "Columns" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}}, DefaultBaseStyle -> 
        "SystemsModelGrid00"], ")"}], #17, 
     ButtonBox[
      GraphicsBox[{
        RectangleBox[{0, 0}, DefaultBaseStyle -> "SystemsModelSuperscript"], 
        InsetBox[
         StyleBox[
         "\[ScriptCapitalS]", DefaultBaseStyle -> 
          "SystemsModelSuperscript"], {0.5, 0.5}]}, ImageSize -> 20], 
      ButtonFunction :> Control`Typesetting`SystemsModelTypesetToggle[
        ButtonNotebook[], FE`CMObj], Evaluator -> Automatic, Appearance -> 
      None], MultilineFunction -> None], 
    EventHandlerTag[{"MouseEntered" :> {FE`CMObj = MathLink`CallFrontEnd[
          FrontEnd`Value[
           FEPrivate`Self[]]]}, PassEventsDown -> True, PassEventsUp -> 
      True}]]& ),
  InterpretationFunction->(RowBox[{"StateSpaceModel", "[", 
     RowBox[{"{", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{1, 2}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{5, 6}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{3, 4}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{7, 8}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{9, 10}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{13, 14}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{11, 12}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{15, 16}, ","], "}"}], "}"}], "}"}], ",", 
     "SamplingPeriod", "->", 
     RowBox[{#17}], ",", "SystemsModelLabels", "->", "None", "]"}]& ),
  Tooltip->StateSpaceModel]], "Output",
 CellChangeTimes->{
  3.802080065005452*^9, 3.802430078745084*^9, {3.802497452994047*^9, 
   3.802497474466597*^9}, 3.802601136213708*^9, 3.8026698428937263`*^9, 
   3.8026706209352837`*^9, 3.802673757350803*^9, 3.802673794138801*^9, 
   3.802673950464957*^9, 3.8026841080364647`*^9, 3.802753072488065*^9, 
   3.802760079364293*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"aad1cf13-7614-4f0d-a587-a1c64082e61a"]
}, Open  ]],

Cell[TextData[{
 "Infinite squeezing at DC when ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["s", "0"], "=", "\[Gamma]"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "3e7cdf22-59f2-47e9-823d-fdb7342ed9aa"]
}], "Text",
 CellChangeTimes->{{3.80199850234051*^9, 
  3.80199852918604*^9}},ExpressionUUID->"3f6a22f1-b28b-47c7-81e3-\
ad227c93f6d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Limit]", 
   RowBox[{"s", 
    UnderscriptBox["\[Rule]", 
     TemplateBox[{},
      "Complexes"]], "0"}]], 
  RowBox[{"Simplify", "[", 
   RowBox[{"umat", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"TransferFunctionModel", "[", "ss", "]"}], "[", "s", "]"}], 
     ")"}], ".", 
    RowBox[{"Inverse", "[", "umat", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8019983237107573`*^9, 3.801998488676717*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"adba363b-2031-4c3d-a262-076c8c5aa235"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ComplexInfinity", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.801998492641746*^9, 3.802079112642014*^9, 3.802430084596794*^9, {
   3.802497457509644*^9, 3.8024974787072372`*^9}, 3.802601140095562*^9, 
   3.8027600830855618`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"daa5c733-1b6e-4564-9a6c-bf07c170164e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SymplecticJ", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"TransferFunctionModel", "[", "ss", "]"}], "[", "s", "]"}], ",", 
    " ", "s"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.802072090119493*^9, 3.802072125700409*^9}, {
  3.8020778212035913`*^9, 3.802077821793515*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"49841536-cdb5-418b-9f05-c2c98c89d37a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.802072098550481*^9, 3.8020721270584593`*^9}, 
   3.8020772114382687`*^9, 3.802077825267795*^9, 3.8020791470674953`*^9, 
   3.802079183261631*^9, 3.8020801240677843`*^9, 3.8024295481975946`*^9, 
   3.802430089649743*^9, {3.802497461057681*^9, 3.8024974817947483`*^9}, 
   3.8026011431405163`*^9, 3.802669953550837*^9, 3.802670178484852*^9, {
   3.802673968174148*^9, 3.802673979440566*^9}, 3.802753078775352*^9, 
   3.80276008614707*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"7fe49ffa-746f-4262-aa4c-9bf85b8b70b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "Simba`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"T", "=", 
  RowBox[{
   RowBox[{"TransformationToRealisable", "[", "ss", "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"StateSpaceTransform", "[", 
  RowBox[{"ss", ",", "T"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.802601161439768*^9, {3.802618310173876*^9, 3.802618312885726*^9}, {
   3.802665397645587*^9, 3.802665400124942*^9}, {3.802665477221879*^9, 
   3.802665495483659*^9}, {3.802665569401649*^9, 3.8026655694633904`*^9}, {
   3.802666067441946*^9, 3.8026660762935963`*^9}, {3.80266640673216*^9, 
   3.802666408465301*^9}, {3.802667457901401*^9, 3.802667487469132*^9}, 
   3.802667528748171*^9, {3.802667561590932*^9, 3.802667601372609*^9}, {
   3.802667678057932*^9, 3.8026676801175737`*^9}, {3.802667822915101*^9, 
   3.802667823623136*^9}, 3.8026692134816217`*^9, {3.802753078506104*^9, 
   3.802753080471816*^9}, {3.802753390936583*^9, 3.802753391823741*^9}, {
   3.80275502687849*^9, 3.802755063028599*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"468d5c34-ccc9-4cb3-b044-d9b34fcf66cd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      SqrtBox[
       RowBox[{
        RowBox[{"2", " ", "\[Gamma]"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[Gamma]", "3"]}]}]]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SqrtBox[
       FractionBox[
        RowBox[{"1", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}], 
        RowBox[{"\[Gamma]", "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Gamma]", "3"]}]}]]], 
      SqrtBox["2"]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SqrtBox["2"], " ", 
        SuperscriptBox["\[Gamma]", "2"]}], 
       SqrtBox[
        RowBox[{"\[Gamma]", "+", 
         RowBox[{"6", " ", 
          SuperscriptBox["\[Gamma]", "3"]}], "+", 
         RowBox[{"8", " ", 
          SuperscriptBox["\[Gamma]", "5"]}]}]]]}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.802753344962536*^9, 3.802753392208886*^9, 3.8027537081880836`*^9, {
   3.802754702201758*^9, 3.802754730414987*^9}, {3.802754767721537*^9, 
   3.80275480302133*^9}, {3.802754953240767*^9, 3.802754974169752*^9}, {
   3.802755027547864*^9, 3.802755063392042*^9}, 3.802755157346057*^9, 
   3.802760086492638*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"b311ded2-3a4d-415f-a4bd-d57880c87232"],

Cell[BoxData[
 TemplateBox[{
   RowBox[{"-", "\[Gamma]"}], "\[Gamma]", 
   RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox["\[Gamma]"]}], "0", "\[Gamma]", 
   RowBox[{"-", "\[Gamma]"}], "0", 
   RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox["\[Gamma]"]}], 
   RowBox[{
     RowBox[{"-", 
       SqrtBox["2"]}], " ", 
     SqrtBox["\[Gamma]"]}], "0", "1", "0", "0", 
   RowBox[{
     RowBox[{"-", 
       SqrtBox["2"]}], " ", 
     SqrtBox["\[Gamma]"]}], "0", "1", 
   InterpretationBox["\[InvisibleSpace]", None], {
   StateSpaceModel, {
    False, False, {
     False, False}}, {$CellContext`stname1, $CellContext`stname2}, {{
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}}, Identity, 
    Automatic, 2, 2, 2, 1, {}, {False, False}, False, Automatic, None, 
    Automatic}, {}},
  "StateSpaceModelFull",
  BaseStyle->{NumberMarks -> False},
  DisplayFunction->(TagBox[
    SubsuperscriptBox[
     RowBox[{"(", 
       GridBox[{{#, #2, #3, #4}, {#5, #6, #7, #8}, {#9, #10, #11, #12}, {#13, \
#14, #15, #16}}, AllowedDimensions -> {4, 4}, 
        GridBoxDividers -> {"Rows" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}, "Columns" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}}, DefaultBaseStyle -> 
        "SystemsModelGrid00"], ")"}], #17, 
     ButtonBox[
      GraphicsBox[{
        RectangleBox[{0, 0}, DefaultBaseStyle -> "SystemsModelSuperscript"], 
        InsetBox[
         StyleBox[
         "\[ScriptCapitalS]", DefaultBaseStyle -> 
          "SystemsModelSuperscript"], {0.5, 0.5}]}, ImageSize -> 20], 
      ButtonFunction :> Control`Typesetting`SystemsModelTypesetToggle[
        ButtonNotebook[], FE`CMObj], Evaluator -> Automatic, Appearance -> 
      None], MultilineFunction -> None], 
    EventHandlerTag[{"MouseEntered" :> {FE`CMObj = MathLink`CallFrontEnd[
          FrontEnd`Value[
           FEPrivate`Self[]]]}, PassEventsDown -> True, PassEventsUp -> 
      True}]]& ),
  InterpretationFunction->(RowBox[{"StateSpaceModel", "[", 
     RowBox[{"{", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{1, 2}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{5, 6}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{3, 4}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{7, 8}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{9, 10}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{13, 14}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{11, 12}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{15, 16}, ","], "}"}], "}"}], "}"}], ",", 
     "SamplingPeriod", "->", 
     RowBox[{#17}], ",", "SystemsModelLabels", "->", "None", "]"}]& ),
  Tooltip->StateSpaceModel]], "Output",
 CellChangeTimes->{
  3.802753344962536*^9, 3.802753392208886*^9, 3.8027537081880836`*^9, {
   3.802754702201758*^9, 3.802754730414987*^9}, {3.802754767721537*^9, 
   3.80275480302133*^9}, {3.802754953240767*^9, 3.802754974169752*^9}, {
   3.802755027547864*^9, 3.802755063392042*^9}, 3.802755157346057*^9, 
   3.802760086758082*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"e05c43dd-ff84-4f35-a7a7-b7b3939ac48c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{
    RowBox[{"MinimalStateSpaceModel", "@", 
     RowBox[{"StateSpaceModel", "[", 
      RowBox[{"TransferFunctionModel", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "transferMatrix"}], "/.", 
          RowBox[{"\[CapitalOmega]", "\[Rule]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "s"}]}]}], "/.", 
         RowBox[{"s", "\[Rule]", 
          RowBox[{"-", "s"}]}]}], ",", " ", "s"}], "]"}], "]"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"T", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TransformationToRealisable", "[", "ss", "]"}], "//", "Refine"}], 
   "//", "Simplify"}]}], "\[IndentingNewLine]", "ssPhysical", "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StateSpaceTransform", "[", 
    RowBox[{"ss", ",", "T"}], "]"}], "//", "Refine"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{
  3.80249951276676*^9, {3.802499593245013*^9, 3.802499594184019*^9}, 
   3.802668289220695*^9, {3.802687292235744*^9, 3.8026873202927*^9}, {
   3.802687399307355*^9, 3.802687447853908*^9}, 3.8027523870212*^9, {
   3.802755618693396*^9, 3.802755635481921*^9}, {3.80275573487332*^9, 
   3.802755735235092*^9}, {3.802760676826735*^9, 3.8027606822226477`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"b7dcfa80-d822-4fb5-ac4a-b82434925cfd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      RowBox[{
       SqrtBox["2"], " ", 
       SqrtBox[
        RowBox[{"\[Gamma]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"s0", " ", "\[Gamma]"}], "+", 
           SuperscriptBox["\[Gamma]", "2"]}], ")"}]}]]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SqrtBox["2"], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"\[Gamma]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["s0", "2"], " ", 
             SuperscriptBox["\[Gamma]", "2"]}], "-", 
            RowBox[{"2", " ", "s0", " ", "\[Gamma]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["\[Gamma]", "2"]}], ")"}]}], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Gamma]", "2"]}], ")"}], "2"]}], ")"}]}], 
         RowBox[{"1", "+", 
          RowBox[{"s0", " ", "\[Gamma]"}], "+", 
          SuperscriptBox["\[Gamma]", "2"]}]]]}]], ",", 
     RowBox[{
      RowBox[{"-", 
       SqrtBox["2"]}], " ", "\[Gamma]", " ", 
      SqrtBox[
       FractionBox["s0", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"s0", " ", "\[Gamma]"}], "+", 
           SuperscriptBox["\[Gamma]", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["s0", "2"], " ", 
            SuperscriptBox["\[Gamma]", "2"]}], "-", 
           RowBox[{"2", " ", "s0", " ", "\[Gamma]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[Gamma]", "2"]}], ")"}]}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["\[Gamma]", "2"]}], ")"}], "2"]}], ")"}]}]]]}]}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8024995142078857`*^9, 3.802499520362838*^9}, {
   3.802499568511479*^9, 3.8024995962877207`*^9}, 3.802601146663713*^9, 
   3.802668295016262*^9, 3.80268726332038*^9, {3.80268730109779*^9, 
   3.8026873216177053`*^9}, {3.802687403321742*^9, 3.8026874483310966`*^9}, {
   3.802687749595997*^9, 3.802687752735648*^9}, 3.802687944868004*^9, 
   3.802753061563766*^9, {3.802755632925332*^9, 3.802755635921702*^9}, {
   3.80275573210745*^9, 3.802755736587326*^9}, 3.802760093842616*^9, 
   3.8027606861045313`*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"333981cb-bd6b-4954-bcd5-d02b413c224a"],

Cell[BoxData[
 TemplateBox[{
   RowBox[{"-", "\[Gamma]"}], 
   SqrtBox[
    RowBox[{"s0", " ", "\[Gamma]"}]], 
   RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox["\[Gamma]"]}], "0", 
   SqrtBox[
    RowBox[{"s0", " ", "\[Gamma]"}]], 
   RowBox[{"-", "\[Gamma]"}], "0", 
   RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox["\[Gamma]"]}], 
   RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox["\[Gamma]"]}], "0", 
   RowBox[{"-", "1"}], "0", "0", 
   RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox["\[Gamma]"]}], "0", 
   RowBox[{"-", "1"}], 
   InterpretationBox["\[InvisibleSpace]", None], {
   StateSpaceModel, {
    False, False, {
     False, False}}, {$CellContext`stname1, $CellContext`stname2}, {{
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}}, Identity, 
    Automatic, 2, 2, 2, 1, {}, {False, False}, False, Automatic, None, 
    Automatic}, {}},
  "StateSpaceModelFull",
  BaseStyle->{NumberMarks -> False},
  DisplayFunction->(TagBox[
    SubsuperscriptBox[
     RowBox[{"(", 
       GridBox[{{#, #2, #3, #4}, {#5, #6, #7, #8}, {#9, #10, #11, #12}, {#13, \
#14, #15, #16}}, AllowedDimensions -> {4, 4}, 
        GridBoxDividers -> {"Rows" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}, "Columns" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}}, DefaultBaseStyle -> 
        "SystemsModelGrid00"], ")"}], #17, 
     ButtonBox[
      GraphicsBox[{
        RectangleBox[{0, 0}, DefaultBaseStyle -> "SystemsModelSuperscript"], 
        InsetBox[
         StyleBox[
         "\[ScriptCapitalS]", DefaultBaseStyle -> 
          "SystemsModelSuperscript"], {0.5, 0.5}]}, ImageSize -> 20], 
      ButtonFunction :> Control`Typesetting`SystemsModelTypesetToggle[
        ButtonNotebook[], FE`CMObj], Evaluator -> Automatic, Appearance -> 
      None], MultilineFunction -> None], 
    EventHandlerTag[{"MouseEntered" :> {FE`CMObj = MathLink`CallFrontEnd[
          FrontEnd`Value[
           FEPrivate`Self[]]]}, PassEventsDown -> True, PassEventsUp -> 
      True}]]& ),
  InterpretationFunction->(RowBox[{"StateSpaceModel", "[", 
     RowBox[{"{", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{1, 2}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{5, 6}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{3, 4}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{7, 8}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{9, 10}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{13, 14}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{11, 12}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{15, 16}, ","], "}"}], "}"}], "}"}], ",", 
     "SamplingPeriod", "->", 
     RowBox[{#17}], ",", "SystemsModelLabels", "->", "None", "]"}]& ),
  Tooltip->StateSpaceModel]], "Output",
 CellChangeTimes->{{3.8024995142078857`*^9, 3.802499520362838*^9}, {
   3.802499568511479*^9, 3.8024995962877207`*^9}, 3.802601146663713*^9, 
   3.802668295016262*^9, 3.80268726332038*^9, {3.80268730109779*^9, 
   3.8026873216177053`*^9}, {3.802687403321742*^9, 3.8026874483310966`*^9}, {
   3.802687749595997*^9, 3.802687752735648*^9}, 3.802687944868004*^9, 
   3.802753061563766*^9, {3.802755632925332*^9, 3.802755635921702*^9}, {
   3.80275573210745*^9, 3.802755736587326*^9}, 3.802760093842616*^9, 
   3.802760686213244*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"e73897cf-0980-4a0b-b7e4-05036ff872c8"],

Cell[BoxData[
 TemplateBox[{
   RowBox[{"-", "\[Gamma]"}], 
   SqrtBox[
    RowBox[{"s0", " ", "\[Gamma]"}]], 
   RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox["\[Gamma]"]}], "0", 
   SqrtBox[
    RowBox[{"s0", " ", "\[Gamma]"}]], 
   RowBox[{"-", "\[Gamma]"}], "0", 
   RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox["\[Gamma]"]}], 
   RowBox[{
     RowBox[{"-", 
       SqrtBox["2"]}], " ", 
     SqrtBox["\[Gamma]"]}], "0", "1", "0", "0", 
   RowBox[{
     RowBox[{"-", 
       SqrtBox["2"]}], " ", 
     SqrtBox["\[Gamma]"]}], "0", "1", 
   InterpretationBox["\[InvisibleSpace]", None], {
   StateSpaceModel, {
    False, False, {
     False, False}}, {$CellContext`stname1, $CellContext`stname2}, {{
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}}, Identity, 
    Automatic, 2, 2, 2, 1, {}, {False, False}, False, Automatic, None, 
    Automatic}, {}},
  "StateSpaceModelFull",
  BaseStyle->{NumberMarks -> False},
  DisplayFunction->(TagBox[
    SubsuperscriptBox[
     RowBox[{"(", 
       GridBox[{{#, #2, #3, #4}, {#5, #6, #7, #8}, {#9, #10, #11, #12}, {#13, \
#14, #15, #16}}, AllowedDimensions -> {4, 4}, 
        GridBoxDividers -> {"Rows" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}, "Columns" -> {False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}}, DefaultBaseStyle -> 
        "SystemsModelGrid00"], ")"}], #17, 
     ButtonBox[
      GraphicsBox[{
        RectangleBox[{0, 0}, DefaultBaseStyle -> "SystemsModelSuperscript"], 
        InsetBox[
         StyleBox[
         "\[ScriptCapitalS]", DefaultBaseStyle -> 
          "SystemsModelSuperscript"], {0.5, 0.5}]}, ImageSize -> 20], 
      ButtonFunction :> Control`Typesetting`SystemsModelTypesetToggle[
        ButtonNotebook[], FE`CMObj], Evaluator -> Automatic, Appearance -> 
      None], MultilineFunction -> None], 
    EventHandlerTag[{"MouseEntered" :> {FE`CMObj = MathLink`CallFrontEnd[
          FrontEnd`Value[
           FEPrivate`Self[]]]}, PassEventsDown -> True, PassEventsUp -> 
      True}]]& ),
  InterpretationFunction->(RowBox[{"StateSpaceModel", "[", 
     RowBox[{"{", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{1, 2}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{5, 6}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{3, 4}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{7, 8}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{9, 10}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{13, 14}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{11, 12}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{15, 16}, ","], "}"}], "}"}], "}"}], ",", 
     "SamplingPeriod", "->", 
     RowBox[{#17}], ",", "SystemsModelLabels", "->", "None", "]"}]& ),
  Tooltip->StateSpaceModel]], "Output",
 CellChangeTimes->{{3.8024995142078857`*^9, 3.802499520362838*^9}, {
   3.802499568511479*^9, 3.8024995962877207`*^9}, 3.802601146663713*^9, 
   3.802668295016262*^9, 3.80268726332038*^9, {3.80268730109779*^9, 
   3.8026873216177053`*^9}, {3.802687403321742*^9, 3.8026874483310966`*^9}, {
   3.802687749595997*^9, 3.802687752735648*^9}, 3.802687944868004*^9, 
   3.802753061563766*^9, {3.802755632925332*^9, 3.802755635921702*^9}, {
   3.80275573210745*^9, 3.802755736587326*^9}, 3.802760093842616*^9, 
   3.802760686801162*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"3c790f02-56c6-4008-b336-33f17d683847"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"RealisableQ", "[", "ssPhysical", "]"}], "\[IndentingNewLine]", 
 RowBox[{"RealisableQ", "[", 
  RowBox[{"StateSpaceTransform", "[", 
   RowBox[{"ss", ",", "T"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.802755765507038*^9, 3.802755768327317*^9}, {
  3.802755846157535*^9, 3.802755900012411*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"6d9845d1-bd2c-4795-a396-4eb919290d3a"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.802755768865831*^9, 3.802755865415985*^9, 
  3.802755900678619*^9, 3.802760095495319*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"122ef5f6-0a70-4b82-873f-a919f958be9f"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.802755768865831*^9, 3.802755865415985*^9, 
  3.802755900678619*^9, 3.8027600956771193`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"44739751-7c1a-4a54-a4bc-40ae611c271a"]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{Automatic, 50}, {Automatic, 48}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3c17d740-6911-4e65-99b1-393d6a7d0249"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 867, 21, 74, "Input",ExpressionUUID->"a2fbf2da-2edd-4e09-a0c2-df7691e02755"],
Cell[1428, 43, 383, 8, 102, "Text",ExpressionUUID->"8e106d1f-18fe-41bc-bfa6-15967becf950"],
Cell[CellGroupData[{
Cell[1836, 55, 7600, 198, 574, "Input",ExpressionUUID->"2b08d5ab-6f7a-4323-9e2a-80fee58a4b41"],
Cell[9439, 255, 1382, 40, 58, "Output",ExpressionUUID->"20d1b5ac-9b01-4535-9e5c-6154205fcefe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10858, 300, 1139, 31, 59, "Input",ExpressionUUID->"361fb27e-7961-439a-a6cf-9acaefaa66a4"],
Cell[12000, 333, 396, 5, 34, "Output",ExpressionUUID->"aaf20332-23f8-4730-9d9e-40c08c27ba07"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12433, 343, 187, 2, 30, "Input",ExpressionUUID->"05a7a15b-acc9-41a3-984b-e629ddec120a"],
Cell[12623, 347, 2162, 62, 58, "Output",ExpressionUUID->"40903f1f-d6fc-4ed7-8aec-0aa9748af522"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14822, 414, 435, 11, 30, "Input",ExpressionUUID->"8c626020-942e-464e-91d8-0446583eed4f"],
Cell[15260, 427, 1390, 41, 56, "Output",ExpressionUUID->"23e8f21d-09ed-4271-ba7c-8872d9d82273"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16687, 473, 1255, 36, 107, "Input",ExpressionUUID->"4f20be1a-bffa-4e5a-9950-3ca713a5fe8d"],
Cell[17945, 511, 3446, 87, 106, "Output",ExpressionUUID->"51aac1df-44d9-46df-9ebd-bd1c8e212076"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21428, 603, 551, 10, 30, "Input",ExpressionUUID->"aaa038bb-2b99-4812-bb36-38aa7111cad9"],
Cell[21982, 615, 786, 11, 34, "Output",ExpressionUUID->"381b35d2-4f6e-4b9c-9333-3949ff8e370a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22805, 631, 1198, 25, 94, "Input",ExpressionUUID->"06abb1b6-cf5f-4ea6-b33a-f18452c28ea1"],
Cell[24006, 658, 7142, 200, 90, "Output",ExpressionUUID->"033477f4-f008-4012-8400-e1d3ce20db14"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31185, 863, 5314, 147, 212, InheritFromParent,ExpressionUUID->"2797ea73-4ba5-40fe-9a2e-85981c9a46d6"],
Cell[36502, 1012, 7023, 198, 90, "Output",ExpressionUUID->"c9b3c89c-7c2d-4a04-8873-6425c2009161"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43562, 1215, 5543, 150, 212, InheritFromParent,ExpressionUUID->"feeae2e0-8c41-4c0a-932e-336a158b171f"],
Cell[49108, 1367, 7240, 202, 90, "Output",ExpressionUUID->"aad1cf13-7614-4f0d-a587-a1c64082e61a"]
}, Open  ]],
Cell[56363, 1572, 381, 11, 35, "Text",ExpressionUUID->"3f6a22f1-b28b-47c7-81e3-ad227c93f6d3"],
Cell[CellGroupData[{
Cell[56769, 1587, 539, 15, 41, "Input",ExpressionUUID->"adba363b-2031-4c3d-a262-076c8c5aa235"],
Cell[57311, 1604, 455, 11, 34, "Output",ExpressionUUID->"daa5c733-1b6e-4564-9a6c-bf07c170164e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57803, 1620, 407, 9, 30, "Input",ExpressionUUID->"49841536-cdb5-418b-9f05-c2c98c89d37a"],
Cell[58213, 1631, 730, 15, 34, "Output",ExpressionUUID->"7fe49ffa-746f-4262-aa4c-9bf85b8b70b6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58980, 1651, 1115, 20, 73, "Input",ExpressionUUID->"468d5c34-ccc9-4cb3-b044-d9b34fcf66cd"],
Cell[60098, 1673, 1372, 41, 77, "Output",ExpressionUUID->"b311ded2-3a4d-415f-a4bd-d57880c87232"],
Cell[61473, 1716, 3594, 87, 106, "Output",ExpressionUUID->"e05c43dd-ff84-4f35-a7a7-b7b3939ac48c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65104, 1808, 1397, 34, 157, "Input",ExpressionUUID->"b7dcfa80-d822-4fb5-ac4a-b82434925cfd"],
Cell[66504, 1844, 2688, 72, 136, "Output",ExpressionUUID->"333981cb-bd6b-4954-bcd5-d02b413c224a"],
Cell[69195, 1918, 3859, 93, 106, "Output",ExpressionUUID->"e73897cf-0980-4a0b-b7e4-05036ff872c8"],
Cell[73057, 2013, 3867, 93, 106, "Output",ExpressionUUID->"3c790f02-56c6-4008-b336-33f17d683847"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76961, 2111, 405, 7, 52, "Input",ExpressionUUID->"6d9845d1-bd2c-4795-a396-4eb919290d3a"],
Cell[77369, 2120, 221, 3, 34, "Output",ExpressionUUID->"122ef5f6-0a70-4b82-873f-a919f958be9f"],
Cell[77593, 2125, 223, 3, 34, "Output",ExpressionUUID->"44739751-7c1a-4a54-a4bc-40ae611c271a"]
}, Open  ]]
}
]
*)

